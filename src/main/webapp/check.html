<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css"/>
    <script src="https://cdn.bootcdn.net/ajax/libs/vue/2.6.10/vue.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/axios/0.18.1/axios.min.js"></script>
    <title>Staff</title>
    <style>
        .el-table th.el-table__cell {
            background: #f5f7fa;
        }
    </style>
</head>
<body>
<div id="app">
    <div style="float: right;margin-bottom: 10px;">
        <el-button type="success" @click="save">save</el-button>
    </div>
    <template>
        <el-table
                :data="tableData"
                v-loading="loading"
                highlight-current-row
                stripe
                size="small"
                border
                style="width: 100%">
            <el-table-column
                    prop="id"
                    label="id"
                    v-if="false">
            </el-table-column>
            <el-table-column
                    prop="orderId"
                    label="orderId"
                    v-if="false">
            </el-table-column>
            <el-table-column
                    prop="connectionString"
                    label="Order list">
            </el-table-column>
            <el-table-column
                    prop="gest"
                    label="Gest">
                <template slot-scope="scope">
                    <el-checkbox v-model="scope.row.gest" :checked="scope.row.gest=='true'? true:false"></el-checkbox>
                </template>
            </el-table-column>
            <el-table-column
                    prop="miss"
                    label="Miss">
                <template slot-scope="scope">
                    <el-checkbox v-model="scope.row.miss" :checked="scope.row.miss=='true'? true:false"></el-checkbox>
                </template>
            </el-table-column>
            <el-table-column
                    prop="wrong"
                    label="Wrong">
                <template slot-scope="scope">
                    <el-input v-model="scope.row.wrong"></el-input>
                </template>
            </el-table-column>
        </el-table>
    </template>
</div>
<script>
    let Main = {
        data() {
            return {
                loading: false,
                selectedRow:{},
                dialogTitle:'',
                actionType:'',
                dialogFormVisible:false,
                tableData: []
            }
        },
        methods: {
            queryChecks(){
                this.loading = true;
                this.actionType = 'query';
                axios.get("CheckServlet", {
                        params: {
                            actionType:this.actionType
                        }
                    }
                ).then(re => {
                    this.tableData = re.data.tableData;
                    this.loading = false;
                })
            },
            save() {
                this.actionType = 'save';
                this.loading = true;
                let formData = new FormData();
                formData.append('tableData', JSON.stringify(this.tableData));
                axios({
                    method: "post",
                    url: "CheckServlet",
                    data: formData
                }).then((res) => {
                    this.loading = false;
                    this.$message({
                        type: 'success',
                        message: 'Saved!'
                    });
                }).catch(re => {
                    this.loading = false;
                    this.$message({
                        type: 'error',
                        message: 'Failed'
                    });
                });
            }
        },
        mounted () {
            this.queryChecks();
        }
    };
    let Ctor = Vue.extend(Main)
    new Ctor().$mount('#app')
</script>
</body>
</html>